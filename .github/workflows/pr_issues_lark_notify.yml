name: PR Lark Notify

on:
    pull_request:
        types:
            - opened
            - edited
            - reopened
            - closed
            - synchronize

jobs:
    notify:
        runs-on: ubuntu-latest
        steps:
            - name: Send Notification
              uses: northwang-lucky/chatbot-webhook-client@v1.1.1
              with:
                  app: Lark
                  webhook: ${{ secrets.LARK_WEBHOOK }}
                  template: >-
                      {
                          "msg_type": "interactive",
                          "card": {
                              "schema": "2.0",
                              "header": {
                                  "title": {
                                      "tag": "plain_text",
                                      "content": "ğŸ”„ Pull Request Update"
                                  },
                                  "template": "green"
                              },
                              "body": {
                                  "direction": "vertical",
                                  "elements": [
                                      {
                                          "tag": "div",
                                          "text": 
                                              {
                                                  "tag": "lark_md",
                                                  "content": "**ä»“åº“ï¼š** ${{ github.event.repository.full_name }}\n**æ ‡é¢˜:** ${{ github.event.pull_request.title }}\n**çŠ¶æ€ï¼š** ${{ github.event.pull_request.state }}\n**æ“ä½œï¼š** ${{ github.event.action }}\n**ä½œè€…ï¼š** ${{ github.event.pull_request.user.login }}\n**è§¦å‘è€…ï¼š** ${{ github.actor }}\n**æ—¶é—´ï¼š** ${{ github.event.pull_request.updated_at }}\n**å†…å®¹ï¼š** \n "
                                              }
                                      },
                                      {
                                          "tag": "div",
                                          "text": {
                                              "tag": "lark_md",
                                              "content": ${{ toJSON(github.event.pull_request.body) }}
                                          }
                                      },
                                      {
                                          "tag": "div",
                                          "text": {
                                              "tag": "lark_md",
                                              "content": "**ä»ï¼š** ${{ github.event.pull_request.head.ref }} â†’ **åˆ°ï¼š** ${{ github.event.pull_request.base.ref }}"
                                          }
                                      },
                                      {
                                          "tag": "button",
                                          "text": {
                                              "tag": "plain_text",
                                              "content": "ğŸ‘‰ æŸ¥çœ‹è¯¦æƒ…"
                                          },
                                          "type": "primary",
                                          "behaviors": [
                                              {
                                                  "type": "open_url",
                                                  "default_url": "${{ github.event.pull_request.html_url }}"
                                              }
                                          ]
                                      }
                                  ]
                              }
                          }
                      }
                  github-token: ${{ secrets.GITHUB_TOKEN }}
